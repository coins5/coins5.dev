---
title: "Async Logging with Loguru: How to Handle Concurrency Without Losing Logs"
author: Marlon Colca
description: "In async apps (FastAPI, asyncio workers, etc.), logging can get tricky.  "
image:
  url: "https://docs.astro.build/default-og-image.png"
  alt: "The word astro against an illustration of planets and stars."
pubDate: 2025-05-03
tags: ["python", "logging", "loguru"]
---

In async apps (FastAPI, asyncio workers, etc.), logging can get tricky.  
If your logs are too fast â€” or your writes too slow â€” you risk blocking the event loop or even losing log lines.

In this post, we'll set up **non-blocking, thread-safe, async-friendly** logging using Loguru.

---

## â— The Problem with Synchronous Logging

If you log directly to disk in a tight async loop:

```python
for i in range(10000):
    logger.info(f"Logging item {i}")
```

You're doing blocking I/O. That means:

- You can slow down your app.
- You may miss logs under high load.
- In extreme cases, your app could crash or stall.

## âœ… The Loguru Solution: Use a Background Thread

Loguru supports enqueue=True, which uses a background thread with a queue:

```python
logger.add("app.log", enqueue=True)
```

Thatâ€™s it. Now your logs wonâ€™t block your event loop.

## ğŸ”¬ How it Works

- Loguru uses a SimpleQueue internally.
- Your app pushes logs instantly.
- A background thread writes them safely.

## ğŸ§ª Example with FastAPI

```python
from fastapi import FastAPI
from loguru import logger

app = FastAPI()

logger.remove()
logger.add("app.log", enqueue=True)

@app.get("/")
async def read_root():
    logger.info("Root endpoint hit")
    return {"message": "hello"}

```

No blocking, no lost logs â€” perfect for production.

## ğŸ“¦ With JSON and Enqueue Combined

You can still use your custom formatters:

```python
logger.add("structured.json", format=json_formatter, enqueue=True)
```

It works exactly the same â€” just async-safe.

## ğŸ§  Tip: Donâ€™t Log Too Much in Tight Loops

Even with async logging, logging inside hot loops or massive async tasks can flood your disk. Use:

- Conditional logs (if debug:)
- Sampling
- Throttling (e.g. log every 1000th event)

## âœ… Conclusion

If you're using FastAPI, asyncio, or any concurrent system â€” always add enqueue=True.
Itâ€™s the easiest way to make your logs safe, fast, and non-blocking.

## ğŸ”œ Coming up next

ğŸ‘‰ _Sending Logs Over the Network: Loguru + Syslog, HTTP, and More_
